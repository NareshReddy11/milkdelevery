<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8"/>
  <title>Account - Shanthi Farms</title>
  <link rel="stylesheet" href="/style.css"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    body {
      background: radial-gradient(ellipse 80% 80% at 50% 20%, #7f9cf5 0%, #6ee7b7 100%) fixed;
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      min-height: 100vh;
    }
    .container {
      max-width: 600px;
      margin: 40px auto;
      background: rgba(255,255,255,0.10);
      border-radius: 32px;
      box-shadow: 0 12px 40px rgba(0,0,0,0.18);
      padding: 56px 36px 36px 36px;
      backdrop-filter: blur(16px);
      text-align: center;
    }
    h3 {
      color: #1a2343;
      margin-bottom: 32px;
      text-align: center;
      font-size: 2.4em;
      font-weight: 800;
      letter-spacing: 1px;
    }
    .section-title {
      color: #2563eb;
      font-size: 1.25em;
      font-weight: 700;
      margin: 32px 0 16px 0;
      text-align: left;
    }
    .card {
      background: rgba(255,255,255,0.18);
      border-radius: 20px;
      box-shadow: 0 2px 12px #0001;
      padding: 28px 22px;
      margin-bottom: 24px;
      backdrop-filter: blur(8px);
      text-align: left;
    }
    .user-info {
      margin-bottom: 18px;
      font-size: 1.15em;
      color: #1a2343;
      font-weight: 500;
    }
    .user-info div {
      margin-bottom: 8px;
    }
    .address-list {
      margin: 0; padding: 0; list-style: none;
    }
    .address-card {
      background: rgba(255,255,255,0.85);
      border-radius: 14px;
      box-shadow: 0 1px 8px #0001;
      padding: 18px 20px;
      margin-bottom: 16px;
      display: flex;
      flex-direction: column;
    }
    .address-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 6px;
    }
    .address-label {
      font-weight: 700;
      font-size: 1.1em;
      color: #2563eb;
    }
    .address-default {
      color: #25D366;
      font-weight: 700;
      font-size: 0.98em;
      margin-left: 8px;
    }
    .address-actions {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    .btn {
      background: linear-gradient(90deg, #34d399 0%, #38bdf8 100%);
      color: #fff;
      border: none;
      border-radius: 12px;
      padding: 10px 22px;
      font-size: 1em;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 2px 8px rgba(52,211,153,0.08);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .btn:hover {
      transform: scale(1.03);
      box-shadow: 0 6px 18px rgba(16,185,129,0.18);
    }
    .btn.delete {
      background: linear-gradient(90deg, #ef4444 0%, #f59e42 100%);
    }
    .add-btn {
      background: linear-gradient(90deg, #2563eb 0%, #38bdf8 100%);
      color: #fff;
      border: none;
      border-radius: 12px;
      padding: 10px 22px;
      font-size: 1em;
      font-weight: 600;
      margin-top: 8px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 2px 8px rgba(52,211,153,0.08);
      display: inline-block;
    }
    .add-btn:hover {
      transform: scale(1.03);
      box-shadow: 0 6px 18px rgba(56,189,248,0.18);
    }
    .actions {
      margin-top: 32px;
      text-align: center;
      display: flex;
      justify-content: center;
      gap: 24px;
    }
    .nav-link {
      background: linear-gradient(90deg, #34d399 0%, #38bdf8 100%);
      color: #fff;
      font-weight: 600;
      text-decoration: none;
      border-radius: 12px;
      padding: 10px 22px;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 2px 8px rgba(52,211,153,0.08);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .nav-link:hover {
      transform: scale(1.03);
      box-shadow: 0 6px 18px rgba(16,185,129,0.18);
      text-decoration: underline;
    }
    .footer {
      text-align: center;
      color: #e0e7ef;
      margin-top: 32px;
      font-size: 0.98em;
    }
    .address-value {
      word-break: break-word;
      overflow-wrap: break-word;
      color: #444;
      margin-bottom: 4px;
      max-width: 100%;
      display: block;
    }
    @media (max-width: 700px) {
      .container { max-width: 100vw; margin: 0; border-radius: 0; box-shadow: none; padding: 16px 6px; }
      .actions { flex-direction: column; gap: 12px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h3>My Account</h3>
    <div class="card user-info">
      <div>Name: <span th:text="${customer.name}"></span></div>
      <div>Phone: <span th:text="${customer.phone}"></span></div>
      <div>User ID: <span th:text="${customer.id}"></span></div>
    </div>
    <div class="section-title">My Addresses:</div>
    <div class="card">
      <ul class="address-list">
        <li th:each="addr : ${addresses}" class="address-card">
          <div class="address-header">
            <span class="address-label" th:text="${addr.label}"></span>
            <span th:if="${addr.isDefault}" class="address-default">Default</span>
          </div>
          <div class="address-value" th:text="${addr.address}"></div>
          <div class="address-actions">
            <button type="button" th:if="!${addr.isDefault}" th:attr="onclick='setDefaultAddress(' + ${addr.id} + ')'" class="btn">
              <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 2v14M2 9h14" stroke="#fff" stroke-width="2" stroke-linecap="round"/></svg>
              Set as Default
            </button>
            <button type="button" th:attr="onclick='deleteAddress(' + ${addr.id} + ')'" class="btn delete">
              <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 4l10 10M14 4L4 14" stroke="#fff" stroke-width="2" stroke-linecap="round"/></svg>
              Delete
            </button>
          </div>
        </li>
      </ul>
      <div th:if="${addresses == null or #lists.size(addresses) == 0}" style="text-align:center; color:#888;">No addresses found.</div>
      <div class="actions"><a th:href="@{/add-address}" class="add-btn">+ Add Address</a></div>
    </div>
    <div class="actions">
      <a href="/home" class="nav-link">
        <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 16l-6-6 6-6" stroke="#fff" stroke-width="2" stroke-linecap="round"/></svg>
        Back
      </a>
      <a href="/logout" class="nav-link">
        <svg width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 2v14M2 9h14" stroke="#fff" stroke-width="2" stroke-linecap="round"/></svg>
        Logout
      </a>
    </div>
    <div class="footer">Â© 2025 Shanthi Farms</div>
  </div>
  <script>
    function setDefaultAddress(id) {
        fetch('/customer/address/default', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: 'addressId=' + id
        }).then(res => res.text()).then(resp => {
            if (resp === 'OK') location.reload();
            else alert('Error setting default address.');
        });
    }
    function deleteAddress(id) {
        if (!confirm('Delete this address?')) return;
        fetch('/customer/address/' + id, {
            method: 'DELETE'
        }).then(res => res.text()).then(resp => {
            if (resp === 'OK') location.reload();
            else alert('Error deleting address.');
        });
    }
  </script>
</body>
</html>
